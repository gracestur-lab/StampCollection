"use strict";(()=>{var e={};e.id=520,e.ids=[520],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},629:e=>{e.exports=require("fs/promises")},5315:e=>{e.exports=require("path")},7775:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>w,patchFetch:()=>y,requestAsyncStorage:()=>j,routeModule:()=>R,serverHooks:()=>N,staticGenerationAsyncStorage:()=>g});var n={};r.r(n),r.d(n,{DELETE:()=>x,PATCH:()=>h,runtime:()=>f});var a=r(9303),s=r(8716),i=r(670),o=r(629),u=r.n(o),l=r(5315),p=r.n(l),d=r(7070),m=r(3493),c=r(7090);let f="nodejs";function v(e){let t=Number(e);return Number.isInteger(t)?t:null}async function h(e,{params:t}){var r,n;let a=v(t.id);if(null==a)return d.NextResponse.json({error:"Invalid stamp id"},{status:400});if(!await m._.stamp.findUnique({where:{id:a}}))return d.NextResponse.json({error:"Stamp not found"},{status:404});let s=await e.json().catch(()=>null);if(!s||"object"!=typeof s)return d.NextResponse.json({error:"Invalid JSON body"},{status:400});let i=function(e){if("string"!=typeof e)return null;let t=e.trim();return t.length?t:null}(s.name),o=null===(r=s.year)||"number"!=typeof r||!Number.isInteger(r)||r<1800||r>2100?null:r,u=function(e){if(null===e||"string"!=typeof e)return null;let t=e.trim();return t.length?t:null}(s.faceValue),l=null===(n=s.theme)||"string"!=typeof n?null:c.Z.includes(n)?n:null;if(void 0!==s.name&&null==i)return d.NextResponse.json({error:"Invalid name"},{status:400});if(void 0!==s.year&&null==o&&null!==s.year)return d.NextResponse.json({error:"Invalid year"},{status:400});if(void 0!==s.faceValue&&null==u&&null!==s.faceValue)return d.NextResponse.json({error:"Invalid face value"},{status:400});if(void 0!==s.theme&&null==l&&null!==s.theme)return d.NextResponse.json({error:"Invalid theme"},{status:400});let p={};void 0!==s.name&&(p.name=i),void 0!==s.year&&(p.year=o),void 0!==s.faceValue&&(p.faceValue=u),void 0!==s.theme&&(p.theme=l),p.needsReview=!1;let f=await m._.stamp.update({where:{id:a},data:p});return d.NextResponse.json({ok:!0,stamp:f})}async function x(e,{params:t}){let r=v(t.id);if(null==r)return d.NextResponse.json({error:"Invalid stamp id"},{status:400});let n=await m._.stamp.findUnique({where:{id:r}});if(!n)return d.NextResponse.json({error:"Stamp not found"},{status:404});await m._.stamp.delete({where:{id:r}});let a=p().join(process.cwd(),"public",n.imagePath.replace(/^\//,""));return await u().unlink(a).catch(()=>{}),d.NextResponse.json({ok:!0})}let R=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/stamps/[id]/route",pathname:"/api/stamps/[id]",filename:"route",bundlePath:"app/api/stamps/[id]/route"},resolvedPagePath:"/Users/chloeclarke/Desktop/Stamp Collection/app/api/stamps/[id]/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:j,staticGenerationAsyncStorage:g,serverHooks:N}=R,w="/api/stamps/[id]/route";function y(){return(0,i.patchFetch)({serverHooks:N,staticGenerationAsyncStorage:g})}},7090:(e,t,r)=>{r.d(t,{Z:()=>n});let n=["ANIMALS","FLOWERS","HISTORICAL","ARCHITECTURE","TRANSPORT","HOLIDAYS","SPACE","SPORTS"]},3493:(e,t,r)=>{r.d(t,{_:()=>a});let n=require("@prisma/client"),a=globalThis.prisma??new n.PrismaClient({log:["error","warn"]})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[276,972],()=>r(7775));module.exports=n})();