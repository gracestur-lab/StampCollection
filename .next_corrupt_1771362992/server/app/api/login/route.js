"use strict";(()=>{var e={};e.id=740,e.ids=[740],e.modules={2934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4770:e=>{e.exports=require("crypto")},2254:e=>{e.exports=require("node:buffer")},6005:e=>{e.exports=require("node:crypto")},7261:e=>{e.exports=require("node:util")},6369:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>f,patchFetch:()=>h,requestAsyncStorage:()=>g,routeModule:()=>m,serverHooks:()=>w,staticGenerationAsyncStorage:()=>x});var n={};r.r(n),r.d(n,{POST:()=>d,runtime:()=>c});var a=r(9303),s=r(8716),i=r(670),o=r(7070),u=r(3493),l=r(9178),p=r(446);let c="nodejs";async function d(e){let t=await e.formData(),r=String(t.get("email")??"").toLowerCase().trim(),n=String(t.get("password")??"");if(!r||!n)return o.NextResponse.json({error:"Email and password are required"},{status:400});let a=await u._.user.findUnique({where:{email:r}});if(!a||!await (0,l.Gv)(n,a.passwordHash))return o.NextResponse.json({error:"Invalid credentials"},{status:401});let s=await (0,l.uy)({sub:a.id,email:a.email}),i=o.NextResponse.json({ok:!0});return i.cookies.set(p.Ls,s,{httpOnly:!0,secure:!0,sameSite:"lax",path:"/",maxAge:604800}),i}let m=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/login/route",pathname:"/api/login",filename:"route",bundlePath:"app/api/login/route"},resolvedPagePath:"/Users/chloeclarke/Desktop/Stamp Collection/app/api/login/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:g,staticGenerationAsyncStorage:x,serverHooks:w}=m,f="/api/login/route";function h(){return(0,i.patchFetch)({serverHooks:w,staticGenerationAsyncStorage:x})}},9178:(e,t,r)=>{r.d(t,{Gv:()=>u,g$:()=>p,uy:()=>l});var n=r(2023),a=r.n(n),s=r(6091),i=r(6176);let o=new TextEncoder().encode(process.env.AUTH_SECRET??"replace-this-in-env-with-a-long-secret");async function u(e,t){return a().compare(e,t)}async function l(e){return new s.N(e).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime("7d").sign(o)}async function p(e){return(await (0,i._)(e,o)).payload}},3493:(e,t,r)=>{r.d(t,{_:()=>a});let n=require("@prisma/client"),a=globalThis.prisma??new n.PrismaClient({log:["error","warn"]})},446:(e,t,r)=>{r.d(t,{Ls:()=>o,Vc:()=>l});var n=r(1615),a=r(8585),s=r(9178),i=r(3493);let o="stamp_session";async function u(){let e=n.cookies().get(o)?.value;if(!e)return null;try{let t=await (0,s.g$)(e);return await i._.user.findUnique({where:{id:t.sub},select:{id:!0,email:!0,name:!0}})}catch{return null}}async function l(){let e=await u();return e||(0,a.redirect)("/login"),e}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[276,972,592],()=>r(6369));module.exports=n})();